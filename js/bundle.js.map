{"version":3,"sources":["webpack:///js/bundle.js","webpack:///webpack/bootstrap ecbc839200fc40a85b79","webpack:///./js/app.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","ready","error","geo","data","boundary","centerZoom","drawSubUnits","drawOuterBoundary","f","colorSubUnits","drawLegend","drawTip","zoom","o","topojson","mesh","objects","outline","a","b","projection","scale","translate","path","bounds","s","Math","max","width","height","t","g","append","datum","attr","selectAll","feature","mumbai","features","enter","d","properties","getFill","w","_","where","party","Object","keys","colors","indexOf","cc","grey","style","makeItem","i","bg","name","seats","$","round","l","length","arr","forEach","wl","push","reduce","tipShow","d3","select","this","moveToFront","ac","show","removeClass","addClass","toString","areas","toTitleCase","tipMove","e","y","pageY","h","offset","top","x","pageX","left","css","tipHide","moveToBack","empty","hide","on","mousemove","clicked","getBoundingBoxCenter","selection","element","node","bbox","getBBox","center","centered","centroid","z","classed","transition","duration","str","replace","txt","charAt","toUpperCase","substr","toLowerCase","geoMercator","red","orange","yellow","green","blue","violet","Shiv Sena","Bharatiya Janata Party","Indian National Congress","Nationalist Congress Party","geoPath","pointRadius","svg","queue","defer","json","csv","await"],"mappings":"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","file":"./js/bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(1)\n\tvar width = $(\"#map\").width(), height = $(\"#map\").height();\n\t\n\tvar projection = d3.geoMercator();\n\t\n\tvar cc = {\n\t  \"red\": \"#fc8d62\",\n\t  \"orange\": \"#fdb462\",\n\t  \"yellow\": \"#ffd92f\",\n\t  \"green\": \"#66c2a5\",\n\t  \"blue\": \"#80b1d3\",\n\t  \"violet\": \"#e78ac3\",\n\t  \"grey\": \"#ccc\"\n\t}\n\t\n\tvar colors = {\n\t  \"Shiv Sena\" : cc.red,\n\t  \"Bharatiya Janata Party\" : cc.orange,\n\t  \"Indian National Congress\" :cc.blue,\n\t  \"Nationalist Congress Party\" : cc.green\n\t};\n\t\n\tvar path = d3.geoPath()\n\t    .projection(projection)\n\t    .pointRadius(2);\n\t\n\tvar svg = d3.select(\"#map\").append(\"svg\")\n\t    .attr(\"width\", width)\n\t    .attr(\"height\", height);\n\t\n\tvar g = svg.append(\"g\");\n\t\n\td3.queue()\n\t    .defer(d3.json, \"data/geodata.json\")\n\t    .defer(d3.csv, \"data/data.csv\")\n\t    .await(ready);\n\t\n\tfunction ready(error, geo, data){\n\t  var boundary = centerZoom(geo);\n\t  drawSubUnits(geo);\n\t  drawOuterBoundary(geo, boundary);\n\t\n\t  f = data;\n\t  colorSubUnits(f);\n\t  drawLegend(f);\n\t  drawTip(f);\n\t  zoom();\n\t}\n\t\n\t// This function \"centers\" and \"zooms\" a map by setting its projection's scale and translate according to its outer boundary\n\t// It also returns the boundary itself in case you want to draw it to the map\n\tfunction centerZoom(data){\n\t\n\t  var o = topojson.mesh(data, data.objects.outline, function(a, b) { return a === b; });\n\t\n\t  projection\n\t      .scale(1)\n\t      .translate([0, 0]);\n\t\n\t  var b = path.bounds(o),\n\t      s = 1 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height),\n\t      t = [(width - s * (b[1][0] + b[0][0])) / 2, (height - s * (b[1][1] + b[0][1])) / 2];\n\t\n\t  projection\n\t      .scale(s)\n\t      .translate(t);\n\t\n\t  return o;\n\t}\n\t\n\tfunction drawOuterBoundary(data, boundary){\n\t  g.append(\"path\")\n\t      .datum(boundary)\n\t      .attr(\"d\", path)\n\t      .attr(\"class\", \"subunit-boundary\");\n\t}\n\t\n\tfunction drawSubUnits(data){\n\t  g.selectAll(\".subunit\")\n\t      .data(topojson.feature(data, data.objects.mumbai).features)\n\t    .enter().append(\"path\")\n\t      .attr(\"class\", function(d){ return \"subunit ac-\" + d.properties.id })\n\t      .attr(\"d\", path);\n\t}\n\t\n\tfunction colorSubUnits(data){\n\t\n\t  g.selectAll(\".subunit\")\n\t      .style(\"fill\", getFill);\n\t\n\t  function getFill(d){\n\t    if (d.properties.id != 0){\n\t      var w = _.where(data, {id: d.properties.id})[0].party;\n\t    }\n\t    return Object.keys(colors).indexOf(w) == -1 ? cc.grey : colors[w];\n\t  }\n\t\n\t}\n\t\n\tfunction drawLegend(data){\n\t  var l = data.length;\n\t\n\t  var keys = Object.keys(colors);\n\t  var arr = [];\n\t  keys.forEach(function(d, i){\n\t    var wl = _.where(data, {party: d}).length;\n\t    arr.push(wl);\n\t    makeItem(i, colors[d], d, wl);\n\t  });\n\t\n\t  var s = arr.reduce(function(a,b){return a + b}, 0);\n\t  if (s - l != 0){\n\t    makeItem(keys.length, cc.grey, \"Other\", l - s);\n\t  }\n\t\n\t  function makeItem(i, bg, name, seats){\n\t    $(\"#legend\").append(\"<div class='legend-item legend-item-\" + i + \"'></div>\");\n\t    $(\".legend-item-\" + i).append(\"<div class='party'></div>\");\n\t    $(\".legend-item-\" + i + \" .party\").append(\"<div class='swatch' style='background:\" + bg + \"'></div>\");\n\t    $(\".legend-item-\" + i + \" .party\").append(\"<div class='result-container'></div>\");\n\t    $(\".legend-item-\" + i +\" .result-container\").append(\"<div class='name'>\" + name + \"</div>\");\n\t    $(\".legend-item-\" + i +\" .result-container\").append(\"<div class='result'></div>\");\n\t    $(\".legend-item-\" + i + \" .result-container .result\").append(\"<div class>\" + seats + \" seats (\" + Math.round((seats / l * 100) * 10) / 10 + \"%)</div>\");\n\t  }\n\t}\n\t\n\tfunction drawTip(data){\n\t\n\t  $(\"body\").append(\"<div class='tip'></div>\");\n\t  $(\".tip\").hide();\n\t\n\t  g.selectAll(\".subunit\")\n\t    .on(\"mouseover\", tipShow)\n\t    .on(\"mouseout\", tipHide);\n\t\n\t  $(\".subunit\").mousemove(tipMove); // do this with jQuery because the d3 version gets messed up when you zoom\n\t\n\t  function tipShow(d){\n\t\n\t    d3.select(this).moveToFront();\n\t    d3.selectAll(\".place-label\").moveToFront();\n\t\n\t    var ac = d.properties.id;\n\t    $(\".tip\").show();\n\t    $(\".subunit\").removeClass(\"highlight\");\n\t    $(\".ac-\" + ac).addClass(\"highlight\");\n\t    var w = _.where(data, {id: ac.toString()})[0];\n\t    var c = Object.keys(colors).indexOf(w.party);\n\t\n\t    $(\".tip\").append(\"<div class='name'>Ward No. \" + w.id +\"</div>\");\n\t    $(\".tip\").append(\"<div class='small-name'>\"+w.areas +\"</div>\");\n\t\n\t    $(\".tip\").append(\"<table></table>\");\n\t    $(\".tip table\").append(\"<tr class='party'></tr>\");\n\t    $(\".tip table .party\").append(\"<td>Party</td>\");\n\t    $(\".tip table .party\").append(\"<td><div class='swatch' style='background:\" + (c == -1 ? cc.grey : colors[w.party]) + \"'></div><div class='party-name'>\" + toTitleCase(w.party) + \"</div></td>\");\n\t    $(\".tip table\").append(\"<tr class='candidate'></tr>\");\n\t    $(\".tip table .candidate\").append(\"<td>Candidate</td>\");\n\t    $(\".tip table .candidate\").append(\"<td>\" + toTitleCase(w.name) + \"</td>\");\n\t\n\t  }\n\t\n\t  function tipMove(e){\n\t\n\t    // calculate top\n\t    var y = e.pageY;\n\t    var h = $(\".tip\").height();\n\t    var o = $(\"#map\").offset().top;\n\t    var t = y - h - 20;\n\t\n\t    // calculate left\n\t    var x = e.pageX;\n\t    var w = $(\".tip\").width();\n\t    var m = $(\"#map\").width() + $(\"#map\").offset().left;\n\t    var l = x - w / 2;\n\t\n\t    $(\".tip\").css({\n\t      top: t < o ? y + 10 : t,\n\t      left: l < 10 ? 10 : l + w + 10 > m ? m - w - 10 : l\n\t    });\n\t\n\t  }\n\t\n\t  function tipHide(d){\n\t\n\t    d3.selectAll(\".subunit\").moveToBack();\n\t    $(\".subunit\").removeClass(\"highlight\");\n\t    $(\".tip\").empty().hide();\n\t\n\t  }\n\t}\n\t\n\t\n\t\n\tvar centered,\n\t  z = 1;\n\t\n\tfunction zoom(){\n\t\n\t  $(\"#map\").append(\"<div class='control zoom'>Zoom out</div>\");\n\t\n\t  $(\".control.zoom\").css(\"top\", $(\"#map\").offset().top + 45).addClass(\"inactive\");\n\t\n\t  g.selectAll(\".subunit\")\n\t      .on(\"click\", clicked);\n\t\n\t}\n\t\n\t// function search(data){\n\t\n\t//   var arr = [];\n\t//   data.forEach(function(d){\n\t//     arr.push(\"Ward No. \"+d.id);\n\t//   });\n\t\n\t//   $(\"#map\").append(\"<input class='control search' placeholder='Search by constituency'></input>\");\n\t//   $(\".control.search\").css({\n\t//     \"right\": 50 + $(\".control.zoom\").width(),\n\t//     \"top\": $(\"#map\").offset().top + 45\n\t//   }).autocomplete({\n\t//     source: arr\n\t//   }).keyup(function(e){\n\t//     if (e.which == 13){\n\t//       searchZoom();\n\t//     }\n\t//   });\n\t\n\t//   $(document).on(\"click\", \".ui-menu-item\", function(){\n\t//     searchZoom();\n\t//   });\n\t\n\t\n\t//   function searchZoom(){\n\t\n\t//     var val = $(\".control.search\").val();\n\t//     var whr = _.where(data, {ac_name: val});\n\t//     var ac = whr != \"\" ? whr[0].ac_no : null;\n\t\n\t//     if (ac){\n\t//       var p = d3.select(\".ac-\" + ac).moveToFront();\n\t//       $(\".subunit\").removeClass(\"highlight\");\n\t//       $(\".ac-\" + ac).addClass(\"highlight\");\n\t//       var center = getBoundingBoxCenter(p);\n\t//       x = center[0];\n\t//       y = center[1];\n\t//       z = 3;\n\t//       $(\".control.zoom\").removeClass(\"inactive\").addClass(\"active\");\n\t//       d3.select(\".control.zoom\")\n\t//           .on(\"click\", clicked);\n\t//       $('.zoom.out').removeClass('inactive');\n\t\n\t//       g.transition()\n\t//         .duration(750)\n\t//         .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")scale(\" + z + \")translate(\" + -x + \",\" + -y + \")\")\n\t//         .style(\"stroke-width\", 1 / z + \"px\");\n\t//     }\n\t//   }\n\t\n\t// }\n\t\n\t// UTILITY FUNCTIONS:\n\t// Can be used in multiple function scalled from ready()\n\t\n\tfunction getBoundingBoxCenter(selection) {\n\t    // get the DOM element from a D3 selection\n\t    // you could also use \"this\" inside .each()\n\t    var element = selection.node(),\n\t    // use the native SVG interface to get the bounding box\n\t    bbox = element.getBBox();\n\t    // return the center of the bounding box\n\t    return [bbox.x + bbox.width/2, bbox.y + bbox.height/2];\n\t}\n\t\n\t// function to execute when a constituency is clicked (which zooms it in and out)\n\tfunction clicked(d){\n\t\n\t  var x, y;\n\t  var boundary = d3.select('.subunit-boundary');\n\t  var center = getBoundingBoxCenter(boundary);\n\t\n\t  if (d && centered !== d) {\n\t    var centroid = path.centroid(d);\n\t    x = centroid[0];\n\t    y = centroid[1];\n\t    z = 3;\n\t    centered = d;\n\t    $('.zoom.out').removeClass('inactive');\n\t  } else {\n\t    x = center[0];\n\t    y = center[1];\n\t    z = 1;\n\t    centered = null;\n\t    $('.zoom.out').addClass('inactive');\n\t  }\n\t\n\t  g.selectAll(\"path\")\n\t     .classed(\"active\", centered && function(d) { return d === centered; });\n\t\n\t  g.transition()\n\t     .duration(750)\n\t     .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")scale(\" + z + \")translate(\" + -x + \",\" + -y + \")\")\n\t     .style(\"stroke-width\", 1 / z + \"px\");\n\t\n\t  $(\".control.zoom\").addClass(z == 1 ? \"inactive\" : \"active\").removeClass(z == 1 ? \"active\" : \"inactive\");\n\t  if (z != 1){\n\t    d3.select(\".control.zoom\")\n\t        .on(\"click\", clicked);\n\t  }\n\t\n\t}\n\t\n\tfunction toTitleCase(str)\n\t{\n\t    return str.replace(/\\w\\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});\n\t}\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// js/bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ecbc839200fc40a85b79","require(\"../css/styles.scss\")\nvar width = $(\"#map\").width(), height = $(\"#map\").height();\n\nvar projection = d3.geoMercator();\n\nvar cc = {\n  \"red\": \"#fc8d62\",\n  \"orange\": \"#fdb462\",\n  \"yellow\": \"#ffd92f\",\n  \"green\": \"#66c2a5\",\n  \"blue\": \"#80b1d3\",\n  \"violet\": \"#e78ac3\",\n  \"grey\": \"#ccc\"\n}\n\nvar colors = {\n  \"Shiv Sena\" : cc.red,\n  \"Bharatiya Janata Party\" : cc.orange,\n  \"Indian National Congress\" :cc.blue,\n  \"Nationalist Congress Party\" : cc.green\n};\n\nvar path = d3.geoPath()\n    .projection(projection)\n    .pointRadius(2);\n\nvar svg = d3.select(\"#map\").append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n\nvar g = svg.append(\"g\");\n\nd3.queue()\n    .defer(d3.json, \"data/geodata.json\")\n    .defer(d3.csv, \"data/data.csv\")\n    .await(ready);\n\nfunction ready(error, geo, data){\n  var boundary = centerZoom(geo);\n  drawSubUnits(geo);\n  drawOuterBoundary(geo, boundary);\n\n  f = data;\n  colorSubUnits(f);\n  drawLegend(f);\n  drawTip(f);\n  zoom();\n}\n\n// This function \"centers\" and \"zooms\" a map by setting its projection's scale and translate according to its outer boundary\n// It also returns the boundary itself in case you want to draw it to the map\nfunction centerZoom(data){\n\n  var o = topojson.mesh(data, data.objects.outline, function(a, b) { return a === b; });\n\n  projection\n      .scale(1)\n      .translate([0, 0]);\n\n  var b = path.bounds(o),\n      s = 1 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height),\n      t = [(width - s * (b[1][0] + b[0][0])) / 2, (height - s * (b[1][1] + b[0][1])) / 2];\n\n  projection\n      .scale(s)\n      .translate(t);\n\n  return o;\n}\n\nfunction drawOuterBoundary(data, boundary){\n  g.append(\"path\")\n      .datum(boundary)\n      .attr(\"d\", path)\n      .attr(\"class\", \"subunit-boundary\");\n}\n\nfunction drawSubUnits(data){\n  g.selectAll(\".subunit\")\n      .data(topojson.feature(data, data.objects.mumbai).features)\n    .enter().append(\"path\")\n      .attr(\"class\", function(d){ return \"subunit ac-\" + d.properties.id })\n      .attr(\"d\", path);\n}\n\nfunction colorSubUnits(data){\n\n  g.selectAll(\".subunit\")\n      .style(\"fill\", getFill);\n\n  function getFill(d){\n    if (d.properties.id != 0){\n      var w = _.where(data, {id: d.properties.id})[0].party;\n    }\n    return Object.keys(colors).indexOf(w) == -1 ? cc.grey : colors[w];\n  }\n\n}\n\nfunction drawLegend(data){\n  var l = data.length;\n\n  var keys = Object.keys(colors);\n  var arr = [];\n  keys.forEach(function(d, i){\n    var wl = _.where(data, {party: d}).length;\n    arr.push(wl);\n    makeItem(i, colors[d], d, wl);\n  });\n\n  var s = arr.reduce(function(a,b){return a + b}, 0);\n  if (s - l != 0){\n    makeItem(keys.length, cc.grey, \"Other\", l - s);\n  }\n\n  function makeItem(i, bg, name, seats){\n    $(\"#legend\").append(\"<div class='legend-item legend-item-\" + i + \"'></div>\");\n    $(\".legend-item-\" + i).append(\"<div class='party'></div>\");\n    $(\".legend-item-\" + i + \" .party\").append(\"<div class='swatch' style='background:\" + bg + \"'></div>\");\n    $(\".legend-item-\" + i + \" .party\").append(\"<div class='result-container'></div>\");\n    $(\".legend-item-\" + i +\" .result-container\").append(\"<div class='name'>\" + name + \"</div>\");\n    $(\".legend-item-\" + i +\" .result-container\").append(\"<div class='result'></div>\");\n    $(\".legend-item-\" + i + \" .result-container .result\").append(\"<div class>\" + seats + \" seats (\" + Math.round((seats / l * 100) * 10) / 10 + \"%)</div>\");\n  }\n}\n\nfunction drawTip(data){\n\n  $(\"body\").append(\"<div class='tip'></div>\");\n  $(\".tip\").hide();\n\n  g.selectAll(\".subunit\")\n    .on(\"mouseover\", tipShow)\n    .on(\"mouseout\", tipHide);\n\n  $(\".subunit\").mousemove(tipMove); // do this with jQuery because the d3 version gets messed up when you zoom\n\n  function tipShow(d){\n\n    d3.select(this).moveToFront();\n    d3.selectAll(\".place-label\").moveToFront();\n\n    var ac = d.properties.id;\n    $(\".tip\").show();\n    $(\".subunit\").removeClass(\"highlight\");\n    $(\".ac-\" + ac).addClass(\"highlight\");\n    var w = _.where(data, {id: ac.toString()})[0];\n    var c = Object.keys(colors).indexOf(w.party);\n\n    $(\".tip\").append(\"<div class='name'>Ward No. \" + w.id +\"</div>\");\n    $(\".tip\").append(\"<div class='small-name'>\"+w.areas +\"</div>\");\n\n    $(\".tip\").append(\"<table></table>\");\n    $(\".tip table\").append(\"<tr class='party'></tr>\");\n    $(\".tip table .party\").append(\"<td>Party</td>\");\n    $(\".tip table .party\").append(\"<td><div class='swatch' style='background:\" + (c == -1 ? cc.grey : colors[w.party]) + \"'></div><div class='party-name'>\" + toTitleCase(w.party) + \"</div></td>\");\n    $(\".tip table\").append(\"<tr class='candidate'></tr>\");\n    $(\".tip table .candidate\").append(\"<td>Candidate</td>\");\n    $(\".tip table .candidate\").append(\"<td>\" + toTitleCase(w.name) + \"</td>\");\n\n  }\n\n  function tipMove(e){\n\n    // calculate top\n    var y = e.pageY;\n    var h = $(\".tip\").height();\n    var o = $(\"#map\").offset().top;\n    var t = y - h - 20;\n\n    // calculate left\n    var x = e.pageX;\n    var w = $(\".tip\").width();\n    var m = $(\"#map\").width() + $(\"#map\").offset().left;\n    var l = x - w / 2;\n\n    $(\".tip\").css({\n      top: t < o ? y + 10 : t,\n      left: l < 10 ? 10 : l + w + 10 > m ? m - w - 10 : l\n    });\n\n  }\n\n  function tipHide(d){\n\n    d3.selectAll(\".subunit\").moveToBack();\n    $(\".subunit\").removeClass(\"highlight\");\n    $(\".tip\").empty().hide();\n\n  }\n}\n\n\n\nvar centered,\n  z = 1;\n\nfunction zoom(){\n\n  $(\"#map\").append(\"<div class='control zoom'>Zoom out</div>\");\n\n  $(\".control.zoom\").css(\"top\", $(\"#map\").offset().top + 45).addClass(\"inactive\");\n\n  g.selectAll(\".subunit\")\n      .on(\"click\", clicked);\n\n}\n\n// function search(data){\n\n//   var arr = [];\n//   data.forEach(function(d){\n//     arr.push(\"Ward No. \"+d.id);\n//   });\n\n//   $(\"#map\").append(\"<input class='control search' placeholder='Search by constituency'></input>\");\n//   $(\".control.search\").css({\n//     \"right\": 50 + $(\".control.zoom\").width(),\n//     \"top\": $(\"#map\").offset().top + 45\n//   }).autocomplete({\n//     source: arr\n//   }).keyup(function(e){\n//     if (e.which == 13){\n//       searchZoom();\n//     }\n//   });\n\n//   $(document).on(\"click\", \".ui-menu-item\", function(){\n//     searchZoom();\n//   });\n\n\n//   function searchZoom(){\n\n//     var val = $(\".control.search\").val();\n//     var whr = _.where(data, {ac_name: val});\n//     var ac = whr != \"\" ? whr[0].ac_no : null;\n\n//     if (ac){\n//       var p = d3.select(\".ac-\" + ac).moveToFront();\n//       $(\".subunit\").removeClass(\"highlight\");\n//       $(\".ac-\" + ac).addClass(\"highlight\");\n//       var center = getBoundingBoxCenter(p);\n//       x = center[0];\n//       y = center[1];\n//       z = 3;\n//       $(\".control.zoom\").removeClass(\"inactive\").addClass(\"active\");\n//       d3.select(\".control.zoom\")\n//           .on(\"click\", clicked);\n//       $('.zoom.out').removeClass('inactive');\n\n//       g.transition()\n//         .duration(750)\n//         .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")scale(\" + z + \")translate(\" + -x + \",\" + -y + \")\")\n//         .style(\"stroke-width\", 1 / z + \"px\");\n//     }\n//   }\n\n// }\n\n// UTILITY FUNCTIONS:\n// Can be used in multiple function scalled from ready()\n\nfunction getBoundingBoxCenter(selection) {\n    // get the DOM element from a D3 selection\n    // you could also use \"this\" inside .each()\n    var element = selection.node(),\n    // use the native SVG interface to get the bounding box\n    bbox = element.getBBox();\n    // return the center of the bounding box\n    return [bbox.x + bbox.width/2, bbox.y + bbox.height/2];\n}\n\n// function to execute when a constituency is clicked (which zooms it in and out)\nfunction clicked(d){\n\n  var x, y;\n  var boundary = d3.select('.subunit-boundary');\n  var center = getBoundingBoxCenter(boundary);\n\n  if (d && centered !== d) {\n    var centroid = path.centroid(d);\n    x = centroid[0];\n    y = centroid[1];\n    z = 3;\n    centered = d;\n    $('.zoom.out').removeClass('inactive');\n  } else {\n    x = center[0];\n    y = center[1];\n    z = 1;\n    centered = null;\n    $('.zoom.out').addClass('inactive');\n  }\n\n  g.selectAll(\"path\")\n     .classed(\"active\", centered && function(d) { return d === centered; });\n\n  g.transition()\n     .duration(750)\n     .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")scale(\" + z + \")translate(\" + -x + \",\" + -y + \")\")\n     .style(\"stroke-width\", 1 / z + \"px\");\n\n  $(\".control.zoom\").addClass(z == 1 ? \"inactive\" : \"active\").removeClass(z == 1 ? \"active\" : \"inactive\");\n  if (z != 1){\n    d3.select(\".control.zoom\")\n        .on(\"click\", clicked);\n  }\n\n}\n\nfunction toTitleCase(str)\n{\n    return str.replace(/\\w\\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/app.js\n// module id = 0\n// module chunks = 0"],"sourceRoot":""}