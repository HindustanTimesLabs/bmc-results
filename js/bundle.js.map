{"version":3,"sources":["webpack:///webpack/bootstrap d0a3a4b1793f7fa2b320","webpack:///./js/app.js","webpack:///./css/styles.scss"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qEAAoE,gBAAgB,EAAE;;AAEtF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kCAAiC,yCAAyC;AAC1E;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,8BAA6B,oBAAoB;AACjD;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,6BAA4B,SAAS;AACrC;AACA;AACA,IAAG;;AAEH,oCAAmC,aAAa;AAChD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,oCAAmC;;AAEnC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA2B,kBAAkB;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA,OAAM;;;AAGN;;AAEA;AACA,iCAAgC,aAAa;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kDAAiD,uBAAuB,EAAE;;AAE1E;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACtSA,0C","file":"./js/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d0a3a4b1793f7fa2b320","require(\"../css/styles.scss\")\nvar width = $(\"#map\").width(), height = $(\"#map\").height();\n\nvar projection = d3.geoMercator();\nvar colors = {\n  \"Shiv Sena\" : cc.red,\n  \"Indian National Congress\" : cc.green,\n  \"MNS\" : cc.orange,\n  \"Bhartiya Janata Party\" : cc.blue\n};\n\nvar path = d3.geoPath()\n    .projection(projection)\n    .pointRadius(2);\n\nvar svg = d3.select(\"#map\").append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n\nvar g = svg.append(\"g\");\n\nd3.queue()\n    .defer(d3.json, \"data/geodata.json\")\n    .defer(d3.csv, \"data/data.csv\")\n    .await(ready);\n\nfunction ready(error, geo, data){\n  var boundary = centerZoom(geo);\n  drawSubUnits(geo);\n  drawOuterBoundary(geo, boundary);\n\n  f = data;\n  colorSubUnits(f);\n  drawLegend(f);\n  drawTip(f);\n  zoom();\n}\n\n// This function \"centers\" and \"zooms\" a map by setting its projection's scale and translate according to its outer boundary\n// It also returns the boundary itself in case you want to draw it to the map\nfunction centerZoom(data){\n\n  var o = topojson.mesh(data, data.objects.outline, function(a, b) { return a === b; });\n\n  projection\n      .scale(1)\n      .translate([0, 0]);\n\n  var b = path.bounds(o),\n      s = 1 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height),\n      t = [(width - s * (b[1][0] + b[0][0])) / 2, (height - s * (b[1][1] + b[0][1])) / 2];\n\n  projection\n      .scale(s)\n      .translate(t);\n\n  return o;\n}\n\nfunction drawOuterBoundary(data, boundary){\n  g.append(\"path\")\n      .datum(boundary)\n      .attr(\"d\", path)\n      .attr(\"class\", \"subunit-boundary\");\n}\n\nfunction drawSubUnits(data){\n  g.selectAll(\".subunit\")\n      .data(topojson.feature(data, data.objects.mumbai).features)\n    .enter().append(\"path\")\n      .attr(\"class\", function(d){ return \"subunit ac-\" + d.properties.id })\n      .attr(\"d\", path);\n}\n\nfunction colorSubUnits(data){\n\n  g.selectAll(\".subunit\")\n      .style(\"fill\", getFill);\n\n  function getFill(d){\n    if (d.properties.id != 0){\n      var w = _.where(data, {id: d.properties.id})[0].party;\n    }\n    return Object.keys(colors).indexOf(w) == -1 ? cc.grey : colors[w];\n  }\n\n}\n\nfunction drawLegend(data){\n  var l = data.length;\n\n  var keys = Object.keys(colors);\n  var arr = [];\n  keys.forEach(function(d, i){\n    var wl = _.where(data, {party: d}).length;\n    arr.push(wl);\n    makeItem(i, colors[d], d, wl);\n  });\n\n  var s = arr.reduce(function(a,b){return a + b}, 0);\n  if (s - l != 0){\n    makeItem(keys.length, cc.grey, \"Other\", l - s);\n  }\n\n  function makeItem(i, bg, name, seats){\n    $(\"#legend\").append(\"<div class='legend-item legend-item-\" + i + \"'></div>\");\n    $(\".legend-item-\" + i).append(\"<div class='party'></div>\");\n    $(\".legend-item-\" + i + \" .party\").append(\"<div class='swatch' style='background:\" + bg + \"'></div>\");\n    $(\".legend-item-\" + i + \" .party\").append(\"<div class='result-container'></div>\");\n    $(\".legend-item-\" + i +\" .result-container\").append(\"<div class='name'>\" + name + \"</div>\");\n    $(\".legend-item-\" + i +\" .result-container\").append(\"<div class='result'></div>\");\n    $(\".legend-item-\" + i + \" .result-container .result\").append(\"<div class>\" + seats + \" seats (\" + Math.round((seats / l * 100) * 10) / 10 + \"%)</div>\");\n  }\n}\n\nfunction drawTip(data){\n\n  $(\"body\").append(\"<div class='tip'></div>\");\n  $(\".tip\").hide();\n\n  g.selectAll(\".subunit\")\n    .on(\"mouseover\", tipShow)\n    .on(\"mouseout\", tipHide);\n\n  $(\".subunit\").mousemove(tipMove); // do this with jQuery because the d3 version gets messed up when you zoom\n\n  function tipShow(d){\n\n    d3.select(this).moveToFront();\n    d3.selectAll(\".place-label\").moveToFront();\n\n    var ac = d.properties.id;\n    $(\".tip\").show();\n    $(\".subunit\").removeClass(\"highlight\");\n    $(\".ac-\" + ac).addClass(\"highlight\");\n    var w = _.where(data, {id: ac.toString()})[0];\n    var c = Object.keys(colors).indexOf(w.party);\n\n    $(\".tip\").append(\"<div class='name'>Ward no. \" + w.id +\"</div>\");\n    $(\".tip\").append(\"<table></table>\");\n    $(\".tip table\").append(\"<tr class='party'></tr>\");\n    $(\".tip table .party\").append(\"<td>Party</td>\");\n    $(\".tip table .party\").append(\"<td><div class='swatch' style='background:\" + (c == -1 ? cc.grey : colors[w.party]) + \"'></div><div class='party-name'>\" + w.party + \"</div></td>\");\n    $(\".tip table\").append(\"<tr class='candidate'></tr>\");\n    $(\".tip table .candidate\").append(\"<td>Candidate</td>\");\n    $(\".tip table .candidate\").append(\"<td>\" + w.name + \"</td>\");\n\n  }\n\n  function tipMove(e){\n\n    // calculate top\n    var y = e.pageY;\n    var h = $(\".tip\").height();\n    var o = $(\"#map\").offset().top;\n    var t = y - h - 20;\n\n    // calculate left\n    var x = e.pageX;\n    var w = $(\".tip\").width();\n    var m = $(\"#map\").width() + $(\"#map\").offset().left;\n    var l = x - w / 2;\n\n    $(\".tip\").css({\n      top: t < o ? y + 10 : t,\n      left: l < 10 ? 10 : l + w + 10 > m ? m - w - 10 : l\n    });\n\n  }\n\n  function tipHide(d){\n\n    d3.selectAll(\".subunit\").moveToBack();\n    $(\".subunit\").removeClass(\"highlight\");\n    $(\".tip\").empty().hide();\n\n  }\n}\n\nvar centered,\n  z = 1;\n\nfunction zoom(){\n\n  $(\"#map\").append(\"<div class='control zoom'>Zoom out</div>\");\n\n  $(\".control.zoom\").css(\"top\", $(\"#map\").offset().top + 45).addClass(\"inactive\");\n\n  g.selectAll(\".subunit\")\n      .on(\"click\", clicked);\n\n}\n\n// function search(data){\n\n//   var arr = [];\n//   data.forEach(function(d){\n//     arr.push(\"Ward No. \"+d.id);\n//   });\n\n//   $(\"#map\").append(\"<input class='control search' placeholder='Search by constituency'></input>\");\n//   $(\".control.search\").css({\n//     \"right\": 50 + $(\".control.zoom\").width(),\n//     \"top\": $(\"#map\").offset().top + 45\n//   }).autocomplete({\n//     source: arr\n//   }).keyup(function(e){\n//     if (e.which == 13){\n//       searchZoom();\n//     }\n//   });\n\n//   $(document).on(\"click\", \".ui-menu-item\", function(){\n//     searchZoom();\n//   });\n\n\n//   function searchZoom(){\n\n//     var val = $(\".control.search\").val();\n//     var whr = _.where(data, {ac_name: val});\n//     var ac = whr != \"\" ? whr[0].ac_no : null;\n\n//     if (ac){\n//       var p = d3.select(\".ac-\" + ac).moveToFront();\n//       $(\".subunit\").removeClass(\"highlight\");\n//       $(\".ac-\" + ac).addClass(\"highlight\");\n//       var center = getBoundingBoxCenter(p);\n//       x = center[0];\n//       y = center[1];\n//       z = 3;\n//       $(\".control.zoom\").removeClass(\"inactive\").addClass(\"active\");\n//       d3.select(\".control.zoom\")\n//           .on(\"click\", clicked);\n//       $('.zoom.out').removeClass('inactive');\n\n//       g.transition()\n//         .duration(750)\n//         .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")scale(\" + z + \")translate(\" + -x + \",\" + -y + \")\")\n//         .style(\"stroke-width\", 1 / z + \"px\");\n//     }\n//   }\n\n// }\n\n// UTILITY FUNCTIONS:\n// Can be used in multiple function scalled from ready()\n\nfunction getBoundingBoxCenter(selection) {\n    // get the DOM element from a D3 selection\n    // you could also use \"this\" inside .each()\n    var element = selection.node(),\n    // use the native SVG interface to get the bounding box\n    bbox = element.getBBox();\n    // return the center of the bounding box\n    return [bbox.x + bbox.width/2, bbox.y + bbox.height/2];\n}\n\n// function to execute when a constituency is clicked (which zooms it in and out)\nfunction clicked(d){\n\n  var x, y;\n  var boundary = d3.select('.subunit-boundary');\n  var center = getBoundingBoxCenter(boundary);\n\n  if (d && centered !== d) {\n    var centroid = path.centroid(d);\n    x = centroid[0];\n    y = centroid[1];\n    z = 3;\n    centered = d;\n    $('.zoom.out').removeClass('inactive');\n  } else {\n    x = center[0];\n    y = center[1];\n    z = 1;\n    centered = null;\n    $('.zoom.out').addClass('inactive');\n  }\n\n  g.selectAll(\"path\")\n     .classed(\"active\", centered && function(d) { return d === centered; });\n\n  g.transition()\n     .duration(750)\n     .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")scale(\" + z + \")translate(\" + -x + \",\" + -y + \")\")\n     .style(\"stroke-width\", 1 / z + \"px\");\n\n  $(\".control.zoom\").addClass(z == 1 ? \"inactive\" : \"active\").removeClass(z == 1 ? \"active\" : \"inactive\");\n  if (z != 1){\n    d3.select(\".control.zoom\")\n        .on(\"click\", clicked);\n  }\n\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/app.js\n// module id = 0\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./css/styles.scss\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}